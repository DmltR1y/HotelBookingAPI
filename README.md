# HotelBookingAPI
HotelBookingAPI - система бронирования отеля на ASP.NET Core 8.0 с аутентификацией JWT

## Предварительные требования
- [.NET 8.0 SDK](https://dotnet.microsoft.com/download/dotnet/8.0)
- [Visual Studio 2022](https://visualstudio.microsoft.com/) или [VS Code](https://code.visualstudio.com/)
- [SQL Server Express](https://www.microsoft.com/en-us/sql-server/sql-server-downloads) (или LocalDB)
- [Git](https://git-scm.com/)

## Установка и запуск

 **Клонируйте репозиторий**

```bash
git clone https://github.com/DmltR1y/HotelBookingAPI.git
cd HotelBookingAPI
Откройте решение в Visual Studio

 **Запустите HotelBookingAPI.sln**

 **База данных создается автоматически**

- При первом запуске создается база HotelBookingDB в LocalDB
- Добавляются тестовые данные: комнаты, типы номеров, гости, администратор

 **Открывается Swagger UI**

- Автоматически откроется: https://localhost:7193
- Или перейдите вручную

## Первый запуск

 **Автоматически создается администратор**:

- Email: admin@hotel.com
- Пароль: Admin123!

 **Для регистрации новых пользователей**:

- Используйте должности: Receptionist или Manager
- Требуется авторизация администратора

## JWT Авторизация в Swagger

- Получите токен через /api/Auth/login
- Введите токен в Swagger (кнопка Authorization),  перед этим написав Bearer
- Токен действителен 8 часов

## Статусы бронирований

- Pending (Ожидание) - Бронь создана, ожидает подтверждения
- Confirmed (Подтверждено) - Бронь подтверждена
- CheckedIn (Заселен) - Гость заселился
- CheckedOut (Выселен)- Гость выселился
- Cancelled (Отменено) - Бронь отменена

## Роли пользователей

- Admin - Полный доступ ко всем функциям
- Manager - Управление бронированиями, комнатами, пользователями
- Receptionist - Работа с гостями и бронированиями

## API

- АУТЕНТИФИКАЦИЯ И ПОЛЬЗОВАТЕЛИ

1. POST /api/Auth/login - Вход в систему
2. POST /api/Auth/register - Регистрация нового пользователя (Требует роли: Администратор, Менеджер)
3. GET /api/Auth/me - Информация о текущем пользователе
4. POST /api/Auth/change-password - Смена пароля

- ТИПЫ НОМЕРОВ

1. GET /api/RoomTypes - Получить все типы номеров
2. GET /api/RoomTypes/1 - Получить тип номера по ID
3. POST /api/RoomTypes - Создать тип номера (Требует роли: Администратор, Менеджер)
4. PUT /api/RoomTypes/1 - Обновить тип номера (Требует роли: Администратор, Менеджер)
5. DELETE /api/RoomTypes/1 - Удалить тип номера (Требует роли: Администратор)

- КОМНАТЫ

1. GET /api/Rooms - Получить все комнаты
2. GET /api/Rooms/1 - Получить комнату по ID
3. GET /api/Rooms/available?checkIn=2025-11-01&checkOut=2024-11-20 - Проверить доступные комнаты
4. POST /api/Rooms - Создать комнату (Требует роли: Администратор, Менеджер)
5. PUT /api/Rooms/1 - Обновить комнату (Требует роли: Администратор, Менеджер)
6. DELETE /api/Rooms/1 - Удалить комнату (Требует роли: Администратор)

- ГОСТИ

1. GET /api/Guests - Получить всех гостей (Требует роли: Администратор, Менеджер, Ресепшионист)
2. GET /api/Guests/1 - Получить гостя по ID (Требует роли: Администратор, Менеджер, Ресепшионист)
3. GET /api/Guests/search?term=Иван - Поиск гостей (Требует роли: Администратор, Менеджер, Ресепшионист)
4. POST /api/Guests - Создать гостя (Требует роли: Администратор, Менеджер, Ресепшионист)
5. PUT /api/Guests/1 - Обновить гостя (Требует роли: Администратор, Менеджер, Ресепшионист)
6. DELETE /api/Guests/1 - Удалить гостя (Требует роли: Администратор, Менеджер, Ресепшионист)

- БРОНИРОВАНИЯ

1. GET /api/Bookings - Получить все бронирования (Требует роли: Администратор, Менеджер, Ресепшионист)
2. GET /api/Bookings/1 - Получить бронирование по ID (Требует роли: Администратор, Менеджер, Ресепшионист)
3. GET /api/Bookings/guest/1 - Получить бронирования гостя (Требует роли: Администратор, Менеджер, Ресепшионист)
4. POST /api/Bookings - Создать бронирование (Требует роли: Администратор, Менеджер, Ресепшионист)
5. PUT /api/Bookings/1/status - Изменить статус бронирования (Требует роли: Администратор, Менеджер, Ресепшионист)
6. GET /api/Bookings/today/checkins - Сегодняшние заезды (Требует роли: Администратор, Менеджер, Ресепшионист)
7. GET /api/Bookings/today/checkouts - Сегодняшние выезды (Требует роли: Администратор, Менеджер, Ресепшионист)
8. DELETE /api/Bookings/1 - Отменить бронирование (Требует роли: Администратор, Менеджер, Ресепшионист)

- УПРАВЛЕНИЕ ПОЛЬЗОВАТЕЛЯМИ

1. GET /api/Users - Получить всех пользователей (Требует роли: Администратор, Менеджер)
2. GET /api/Users/1 - Получить пользователя по ID (Требует роли: Администратор, Менеджер)
3. DELETE /api/Users/1 - Удалить пользователя (Требует роли: Администратор)
4. PUT /api/Users/1/roles - Обновить роли пользователя (Требует роли: Администратор)

## КОДЫ ОТВЕТОВ И ОШИБКИ

1. Успешные ответы:

- 200 OK - Успешный запрос
- 201 Created - Успешное создание ресурса
- 204 No Content - Успешное удаление

2. Ошибки клиента:

- 400 Bad Request - Неверные параметры запроса
- 401 Unauthorized - Требуется аутентификация
- 403 Forbidden - Недостаточно прав
- 404 Not Found - Ресурс не найден

3. Ошибки сервера:

- 500 Internal Server Error - Внутренняя ошибка сервера
